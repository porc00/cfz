"use strict";angular.module("frontendApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngGrid","mgcrea.ngStrap"]).config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/maquinas",{templateUrl:"views/maquinas.html",controller:"MaquinasCtrl"}).when("/clientes",{templateUrl:"views/clientes_list_view.html",controller:"ClienteCtrl"}).when("/clientes/novo",{templateUrl:"views/clientes_form.html",controller:"CadastroClienteCtrl"}).when("/clientes/edicao/:clienteId",{templateUrl:"views/clientes_form.html",controller:"CadastroClienteCtrl"}).when("/maquinas/edicao/:maquinaId",{templateUrl:"views/cadastro_maquina.html",controller:"CadastroMaquinaCtrl"}).when("/maquinas/novo",{templateUrl:"views/cadastro_maquina.html",controller:"CadastroMaquinaCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("frontendApp").controller("MainCtrl",["$scope","MaquinaService",function(a,b){a.maquinas=b.listMaquinas()}]),angular.module("frontendApp").controller("MaquinasCtrl",["$scope","MaquinaService","MessageService",function(a,b,c){a.mostraForm=!1,a.mostraFormHistorico=!1,a.maquinas=b.listMaquinas(),c.verificarSeTemMensagem("#mensagens")}]),angular.module("frontendApp").controller("DefeitosCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("frontendApp").controller("MainmenuCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("frontendApp").directive("numbersOnly",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){if(void 0==a)return"";var b=a.replace(/[^0-9]/g,"");return b!=a&&(d.$setViewValue(b),d.$render()),b})}}}),angular.module("frontendApp").service("Memoria",function(){return{}}),angular.module("frontendApp").directive("maquina",function(){return{templateUrl:"/views/template_maquina.html",restrict:"E",controller:"MaquinasCtrl",scope:{maquina:"=maquina"}}}),angular.module("frontendApp").service("MaquinaService",[function(){this.maquinas=[{id:"0",nuGarantia:"asx304",desc:"uma bela maquina"}],this.criarMaquina=function(){var a={},b=[],c={tipoHistorico:"Registrado",data:new Date,podeExcluir:!1};return b.push(c),a.historico=b,a},this.listMaquinas=function(){return this.maquinas},this.saveMaquina=function(a){if(void 0==this.maquinas&&(this.maquinas=[]),void 0!=a.id){var b=this.maquinas.indexOf(a);this.maquinas[b]=a}else a.id=this.maquinas.length,this.maquinas.push(a)},this.findMaquinaPorID=function(a){return this.maquinas.filter(function(b){return b.id==a})[0]},this.excluirMaquina=function(a){var b=this.maquinas.indexOf(a);this.maquinas.splice(b,1)}}]),angular.module("frontendApp").directive("formMaquina",function(){return{templateUrl:"/views/cadastro_maquina.html",restrict:"E",controller:"MaquinasCtrl"}}),angular.module("frontendApp").directive("selecionadorCliente",function(){return{templateUrl:"/views/selecionador_cliente_view.html",restrict:"E",controller:"SelecionadorClienteCtrl",scope:{entidade:"=entidade"}}}),angular.module("frontendApp").controller("SelecionadorClienteCtrl",["$scope","ClienteService",function(a,b){function c(a,b,c){void 0==a&&(a={}),a[b]=c}function d(b){if(b.selected){void 0==a.entidade&&(a.entidade={});var d=a.gridClientes.selectedItems[0].nome;c(a.entidade,"cliente",d)}}a.clientes=b.listClientes(),a.filterOptions={filterText:""},a.gridClientes={filterOptions:a.filterOptions,data:"clientes",multiSelect:!1,afterSelectionChange:d,selectedItems:[]}}]),angular.module("frontendApp").service("ClienteService",function(){function a(){return e}function b(a){if(void 0!=a.id){var b=e.indexOf(a);e[b]=a}else a.id=e.length,e.push(a)}function c(a){var b=e.indexOf(a);e.splice(b,1)}function d(a){return e.filter(function(b){return b.id==a})[0]}var e=[{id:0,nome:"maria",email:"maria@gmail.com"},{id:1,nome:"joana",email:"joana@hotmila.com"}];return{listClientes:a,salvarCliente:b,findClientePorID:d,excluirCliente:c,clientes:e}}),angular.module("frontendApp").controller("ClienteCtrl",["$scope","$location","$alert","ClienteService","MessageService",function(a,b,c,d,e){function f(c){if(c.selected){var d=a.gridClientes.selectedItems[0].id;b.path("/clientes/edicao/"+d)}}e.verificarSeTemMensagem("#mensagens"),a.mostraBusca=!0,a.clientes=d.listClientes(),a.filterOptions={filterText:""},a.gridClientes={filterOptions:a.filterOptions,data:"clientes",multiSelect:!1,afterSelectionChange:f,selectedItems:[],columnDefs:[{field:"nome",displayName:"Nome"},{field:"email",displayName:"E-mail"}]}}]),angular.module("frontendApp").controller("CadastroMaquinaCtrl",["$scope","$location","$routeParams","MessageService","MaquinaService","TipoHistoricoService",function(a,b,c,d,e,f){function g(){var b=e.findMaquinaPorID(c.maquinaId);a.maquina=b}function h(){a.maquina=e.criarMaquina()}function i(a,b){a.sort(function(a,c){return new Date(a[b])-new Date(c[b])})}a.mostraFormHistorico=!1,a.tiposHistorico=f.listTipoHistorico(),void 0!=c.maquinaId?(g(c),a.operacao={nome:"Edição",tipo:"edicao"}):(a.operacao={nome:"Cadastro",tipo:"cadastro"},h()),a.formHistoricoTemErro=function(a){return 0==a.data.$valid||0==a.tipoHistorico.$valid},a.formMaquinaTemErro=function(a){return 0==a.modelo.$valid||0==a.nuGarantia.$valid},a.adicionarItemHistorico=function(b){a.maquina.historico=a.maquina.historico||[],a.maquina.historico.push(b),i(a.maquina.historico,"data"),b=null},a.removerItemHistorico=function(b){if(a.maquina.historico){var c=a.maquina.historico.indexOf(b);a.maquina.historico.splice(c,1),i(a.maquina.historico,"data")}},a.excluirMaquina=function(c){e.excluirMaquina(c),d.adicionarMensagem("Maquina "+a.maquina.nuGarantia+" excluida com sucesso."),b.path("/maquinas")},a.salvarMaquina=function(){e.saveMaquina(a.maquina),d.adicionarMensagem("Maquina "+a.maquina.nuGarantia+" salva com sucesso."),a.maquina=null,a.historico=null,b.path("/maquinas")},a.voltar=function(){b.path("/maquinas")}}]),angular.module("frontendApp").service("TipoHistoricoService",function(){function a(){return b}var b=[{id:0,value:"Retornado do cliente"},{id:1,value:"Enviado ao cliente"}];return{listTipoHistorico:a}}),angular.module("frontendApp").directive("ngConfirmClick",[function(){return{restrict:"A",link:function(a,b,c){b.bind("click",function(){var b=c.ngConfirmMessage;b&&confirm(b)&&a.$apply(c.ngConfirmClick)})}}}]),angular.module("frontendApp").controller("CadastroClienteCtrl",["$scope","$routeParams","$location","ClienteService","MessageService",function(a,b,c,d,e){function f(b){var c=d.findClientePorID(b.clienteId);a.cliente=c}void 0!=b.clienteId?(f(b),a.operacao={nome:"Edição",tipo:"edicao"}):a.operacao={nome:"Cadastro",tipo:"cadastro"},a.salvarCliente=function(a){d.salvarCliente(a),e.adicionarMensagem("Cliente "+a.nome+" cadastrado com sucesso!."),c.path("/clientes")},a.excluirCliente=function(a){d.excluirCliente(a),e.adicionarMensagem("Cliente "+a.nome+" excluido com sucesso!."),c.path("/clientes")}}]),angular.module("frontendApp").service("MessageService",["$alert",function(a){this.messages=[],this.adicionarMensagem=function(a){this.messages.push(a)},this.pegarUltimaMensagem=function(){return this.messages.pop()},this.temMensagem=function(){return this.messages.length>0},this.verificarSeTemMensagem=function(b){if(this.temMensagem()){var c=this.pegarUltimaMensagem();a({title:"Sucesso!",content:c,placement:"top",type:"success",keyboard:!0,show:!0,container:b,duration:3})}}}]);